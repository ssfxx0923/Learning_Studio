{
  "nodes": [
    {
      "parameters": {
        "operation": "write",
        "fileName": "=/root/Learning_Studio/public/data/english/artikel/{{ $('Webhook').item.json.body.request_id }}/audio.mp3",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -10224,
        -3264
      ],
      "id": "6a936525-8d2e-4e56-b79b-e2c39b20a9df",
      "name": "Read/Write Files from Disk"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.fish.audio/v1/tts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "s1"
            },
            {
              "name": "Accept",
              "value": "audio/mpeg"
            },
            {
              "name": "Authorization",
              "value": "Bearer bc3c9c4104974d28bbd8ee0600d25fbd"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "text",
              "value": "= {{ $json.output.Body }}"
            },
            {
              "name": "format",
              "value": "mp3"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -10640,
        -3264
      ],
      "id": "35275fb1-cfe2-454c-9764-ea2ce9e0a90b",
      "name": "语音生成"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://open.bigmodel.cn/api/paas/v4/images/generations",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer 02c67b1b817747ec8cf94cce25bad339.rnRLhNg7slZOwT4K"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "cogView-4-250304"
            },
            {
              "name": "prompt",
              "value": "={{ $json.output.cover }}"
            },
            {
              "name": "size",
              "value": "1792x1024"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -10640,
        -3664
      ],
      "id": "8cf8deb1-d1ac-4b84-8669-66f392f3b148",
      "name": "图片生成"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.message }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=你是一个英语学习辅助助手。用户会输入若干英文单词，请写一篇约 100 词的有趣英文短文，兼顾流畅度和单词使用量。\n你只需要返回纯粹的json。格式，不要附带任何解释和说明。\njson格式如下:\n{\"Title\": \"California\", \"Body\": \"Your English essay related to the keyword\", \"Words\": [\"word1\", \"word2\", \"word3\"]}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -11584,
        -3488
      ],
      "id": "95213371-5ab6-42bc-9450-6fe35131bbba",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "glm-4.5",
          "mode": "list",
          "cachedResultName": "glm-4.5"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -11584,
        -3280
      ],
      "id": "55d5465b-a5da-499a-a63e-2a9b63be26f0",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "yK0fgk8FcJgoqsnQ",
          "name": "OpenAi account 2"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\"Title\": \"California\", \"Body\": \"Your English essay related to the keyword\", \"Words\": [\"word1\", \"word2\", \"word3\"]}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -11440,
        -3280
      ],
      "id": "996a89b2-5124-4801-9376-038fabdf4987",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://open.bigmodel.cn/api/paas/v4/images/generations",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer 02c67b1b817747ec8cf94cce25bad339.rnRLhNg7slZOwT4K"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "cogView-4-250304"
            },
            {
              "name": "prompt",
              "value": "={{ $json.output.middle }}"
            },
            {
              "name": "size",
              "value": "1792x1024"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -10608,
        -3904
      ],
      "id": "9b1eeb45-daa0-4ac4-bd67-9514130c4fd0",
      "name": "图片生成1"
    },
    {
      "parameters": {
        "url": "={{ $json.data[0].url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -10400,
        -3904
      ],
      "id": "af286e9c-ef3e-42ca-94de-380abeb7d3fe",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "url": "={{ $json.data[0].url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -10432,
        -3664
      ],
      "id": "d7423987-327b-427d-98ed-623a8647ec2a",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "=/root/Learning_Studio/public/data/english/artikel/{{ $('Webhook').item.json.body.request_id }}/middle.png",
        "options": {
          "append": false
        }
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -10192,
        -3904
      ],
      "id": "8fe93522-ae8f-48bc-93fd-c4dcff3adc8c",
      "name": "Read/Write Files from Disk1"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "=/root/Learning_Studio/public/data/english/artikel/{{ $('Webhook').item.json.body.request_id }}/cover.png",
        "options": {
          "append": false
        }
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -10208,
        -3664
      ],
      "id": "168ef645-5669-4675-aa75-aa8903a1f59f",
      "name": "Read/Write Files from Disk2"
    },
    {
      "parameters": {
        "content": "# 使用AI，实现单词到短文的生成。\n\n# 执行这个url会生成两张图片和一份音频，用于搭建阅读模板",
        "height": 1696,
        "width": 2448,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -12336,
        -4240
      ],
      "typeVersion": 1,
      "id": "39601f66-0317-49e4-afb6-da9cdf824cc2",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "english/generate",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -11856,
        -3488
      ],
      "id": "d394b291-5222-469b-9ce5-59eff907828a",
      "name": "Webhook",
      "webhookId": "e155b53a-e6bc-4d80-a7ac-b4ec8d525119"
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "=/root/Learning_Studio/public/data/english/artikel/{{ $('Webhook').item.json.body.request_id }}/content.json",
        "dataPropertyName": "=data",
        "options": {}
      },
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        -10208,
        -3456
      ],
      "id": "58a1a79e-11e6-4bc1-9522-fe6b439873d9",
      "name": "Read/Write Files from Disk3"
    },
    {
      "parameters": {
        "operation": "toJson",
        "options": {}
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -10640,
        -3456
      ],
      "id": "9a818531-d32b-4032-b413-2e895fea4b4d",
      "name": "Convert to File"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "english/translate",
        "responseMode": "lastNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -12080,
        -2448
      ],
      "id": "b9908e20-3c78-4499-8e49-74549ed6417b",
      "name": "Webhook_Translate",
      "webhookId": "6a373184-55f7-42fb-978d-dc92de20223f"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.word }}",
        "options": {
          "systemMessage": "你是一个专业的英语翻译助手。请将用户提供的英文文本翻译成简洁、准确的中文。只返回翻译结果，不要添加任何解释。"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -11744,
        -2448
      ],
      "id": "af6d82ad-b293-438d-acf6-2bbbb755cc17",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -11744,
        -2256
      ],
      "id": "ed17c370-374e-452c-b59c-9b917be7299d",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "Ja1oOqdJYdJ0EpPS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "# 划词翻译",
        "height": 560,
        "width": 1616
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -12336,
        -2512
      ],
      "typeVersion": 1,
      "id": "13bc970b-5bd7-49e3-aff3-58b600f79d02",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "english/analyze",
        "responseMode": "lastNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -12080,
        -1776
      ],
      "id": "2e6aa8e4-b272-49e3-9de4-12b759552853",
      "name": "Webhook_Analyze",
      "webhookId": "8f9e3d21-4c85-44ff-b256-9a8e7f8d6c3e"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.text }}",
        "options": {
          "systemMessage": "你是一个专业的英语教学助手。请分析用户提供的英文文本，包括：\n1. 语法结构分析\n2. 重点词汇解释\n3. 句子含义和用法\n4. 相关例句（如适用）\n请用简洁、易懂的中文回答，帮助学习者更好地理解这段文本。"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -11728,
        -1776
      ],
      "id": "c6971926-f0d9-43ad-a3b3-44b0ff83a8ec",
      "name": "AI Agent2"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -11728,
        -1584
      ],
      "id": "d0053527-6db4-4c2b-8dd3-b1164b1c9889",
      "name": "OpenAI Chat Model3",
      "credentials": {
        "openAiApi": {
          "id": "Ja1oOqdJYdJ0EpPS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "# 划词解析\n",
        "height": 560,
        "width": 1616
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -12336,
        -1888
      ],
      "typeVersion": 1,
      "id": "af1bd319-03fe-4c9f-abe3-ef03ae075eea",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.output }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=你是一个专业的ai绘图师，你的任务就是深入理解用户提供的短文。为其生专业的ai绘画提示词。对应一篇文章，你要描述两个图片。\n1.封面图(cover)：阅读整篇文章根据文章内容，描绘一幅紧扣文章主题的封面图。\n2.中间图(middle)：另外选择一个最有趣画面进行描述，生成一个中间配图。\n你需要返回严格的单行json。格式，不要附带任何解释和说明。json格式如下:\n{\"cover\": \"California\", \"middle\": \"California\"}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -11040,
        -3824
      ],
      "id": "7de8066a-d9f1-4a18-b423-261955bed33e",
      "name": "AI Agent3"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "id"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -11040,
        -3616
      ],
      "id": "db0848e0-01ce-4e6a-b9d5-9d15ed0f3be3",
      "name": "OpenAI Chat Model2",
      "credentials": {
        "openAiApi": {
          "id": "Ja1oOqdJYdJ0EpPS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n\t\"cover\": \"California\",\n\t\"middle\": \"California\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -10896,
        -3616
      ],
      "id": "4154ffa3-3786-4ccd-9bc2-bca9309d5950",
      "name": "Structured Output Parser1"
    }
  ],
  "connections": {
    "语音生成": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "图片生成": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "语音生成",
            "type": "main",
            "index": 0
          },
          {
            "node": "Convert to File",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI Agent3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "图片生成1": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook_Translate": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Webhook_Analyze": {
      "main": [
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent3": {
      "main": [
        [
          {
            "node": "图片生成1",
            "type": "main",
            "index": 0
          },
          {
            "node": "图片生成",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "1eed45ddd9333e8c5f9a70a2fae0ffba743218818c24507da9d021fdaa9893e1"
  }
}